<div id="accordion">
  <!--
    <routine-collapse *ngFor="let routine of  routines"
        [routine]="routine"
  ></routine-collapse>-->
  <div class="alert alert-info"
    *ngIf="routines.length == 0">
    Aktuell hast du noch <strong>keine Routinen</strong> eingerichtet.
    <button type="button"
            class="btn btn-primary"
            (click)="openModal(addRoutineModal, 'xl')"
    >Neue Routine erzeugen</button>
  </div>
  <routine-collapse
    *ngFor="let routine of routines"
    [routine]="routine"
    [editName]="true"
  ></routine-collapse>

</div>

<ng-template #addRoutineModal>
  <!-- Modal Header -->
  <div class="modal-header">
    <h4 class="modal-title">Neue Routine anlegen</h4>
    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
  </div>

  <!-- Modal body -->
  <div class="modal-body">
    <div *ngIf="postRoutine; else inputFields" class="spinner-border text-primary" style="justify-content: center">
    </div>
    <ng-template #inputFields>
      <form action="/action_page.php">
        <div class="mb-3 mt-3">
          <label for="name" class="form-label">Name:</label>
          <input type="text" class="form-control" id="name" placeholder="Gib den Namen der Routine ein" name="name">
        </div>
        <div class="mb-3">
          <label for="description" class="form-label">Beschreibung:</label>
          <input type="text" class="form-control" id="description" placeholder="Gib eine Beschreibung an" name="description">
        </div>
        <div class="row">
          <div class="col-lg-2 border-end">
            wiederholen an jedem...
            <div class="form-check mb-3">
              <div class="row">
                <div class="col-md-2 p-2">
                  <div class="form-check">
                    <label class="form-check-label mb-auto">
                      Montag
                      <input class="form-check-input" type="checkbox" name="monday">
                    </label>
                  </div>
                  <div class="form-check mb-auto">
                    <label class="form-check-label">
                      Dienstag
                      <input class="form-check-input" type="checkbox" name="tuesday">
                    </label>
                  </div>
                  <div class="form-check">
                    <label class="form-check-label">
                      Mittwoch
                      <input class="form-check-input" type="checkbox" name="wednesday">
                    </label>
                  </div>
                  <div class="form-check">
                    <label class="form-check-label">
                      Donnerstag
                      <input class="form-check-input" type="checkbox" name="thursday">
                    </label>
                  </div>
                </div>

                <div class="col-md-2 p-2">
                  <div class="form-check">
                    <label class="form-check-label">
                      Freitag
                      <input class="form-check-input" type="checkbox" name="friday">
                    </label>
                  </div>
                  <div class="form-check">
                    <label class="form-check-label">
                      Samstag
                      <input class="form-check-input" type="checkbox" name="saturday">
                    </label>
                  </div>
                  <div class="form-check">
                    <label class="form-check-label">
                      Sonntag
                      <input class="form-check-input" type="checkbox" name="sunday">
                    </label>
                  </div>
                </div>
              </div>
          </div>
            <div class="border-top">
              <div>
                an einem bestimmten Datum:
                <div *ngIf="emptyRoutine.dateOfDay">
                  <div *ngFor="let date of emptyRoutine.dateOfDay">
                    <input type="date"
                           placeholder="Datum eingeben"
                           (change)="onEmptyRoutineDateChange($event)">
                  </div>
                </div>
                <div style="justify-items: center">
                  <mat-icon class="add-button"
                            (click)="onAddDateToEmptyRoutine()"
                  >add_circle</mat-icon>
                </div>
              </div>
            </div>
        </div>
        <div class="col-lg-2">
          um x Uhr:
          <ul class="list-group" *ngIf="emptyRoutine.clock_time.length > 0; else createFirstTime" id="times">
            <div class="input-group mb-3" *ngFor="let time of emptyRoutine.clock_time">
              <input matTimepicker class="form-control"
                     #t="matTimepicker"
                     mode="24h"
                     [value]=time
                     [strict]="false"
                     (timeChange)="onEmptyRoutineTimeChange($event)"
              >
              <button class="btn btn-primary" type="button" (click)="t.showDialog()"><mat-icon>edit</mat-icon></button>
              <button class="btn btn-danger" type="button" (click)="onEmptyTimeDelete(time)"><mat-icon>delete_forever</mat-icon></button>
            </div>
            <mat-icon class="add-button" (click)="onAddTimeToEmptyRoutine()">add_circle</mat-icon>
          </ul>
          <ng-template #createFirstTime>
            <div class="alert alert-sm alert-secondary">
              <strong>Aktuell wird die Rutine zu keiner festen Uhrzeit gestartet!</strong> Wenn du m√∂chtest, kannst du jetzt <button class="btn btn-secondary btn-sm" (click)="onAddTimeToEmptyRoutine()">eine Uhrzeit bestimmen</button>.
            </div>
          </ng-template>
          <div>
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="afterSunrise" name="afterSunrise" (click)="onEmptyRepeatChange('sunrise', $event)">
              <label class="form-check-label" for="afterSunrise">nach Sonnenaufgang</label>
            </div>
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="afterSunset" name="afterSunrise" (click)="onEmptyRepeatChange('sunset', $event)">
              <label class="form-check-label" for="afterSunset">nach Sonnenuntergang</label>
            </div>
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="afterAlarm" name="afterAlarm"  (click)="onEmptyRepeatChange('alarm', $event)">
              <label class="form-check-label" for="afterAlarm">nach Wecker</label>
            </div>
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="afterCall" name="afterCall"  (click)="onEmptyRepeatChange('call', $event)">
              <label class="form-check-label" for="afterSunrise">nach Nutzeraufruf</label>
            </div>
          </div>
        </div>
        </div>
        <div>
          aufgerufene Module:
          <ul class="list-group">
            <li *ngFor="let item of emptyCommands">
              <select class="form-select" [value]="item.moduleName">
                <option *ngFor="let name in moduleNames">name</option>
              </select>
              <ul class="list-group">
                <li class="list-group-item" *ngFor="let text of item.text">
                  <div class="input-group">
                    <input type="text" #input class="form-control" [value]="text" (change)="onChangeCommandOfEmptyRoutine(item.id, input.value)">
                  </div>
                </li>
              </ul>
              <button class="btn btn-danger" type="button" (click)="onEmptyTimeDelete(item.id)"><mat-icon>delete_forever</mat-icon></button>
            </li>
            <li class="list-group-item"><mat-icon class="add-button" (click)="onAddCommandToEmptyRoutine()">add_circle</mat-icon></li>
          </ul>
        </div>
        <div class="form-check mb-3">
          <label class="form-check-label">
            <input class="form-check-input" type="checkbox" name="remember"> Remember me
          </label>
        </div>
      </form>
    </ng-template>

  </div>

  <!-- Modal footer -->
  <div class="modal-footer">
    <div class="btn-group">
      <button type="button" class="btn btn-primary" (click)="onAddRoutine()">speichern</button>
      <button type="button" class="btn btn-danger" (click)="onDiscardRoutine()">verwerfen</button>
    </div>
  </div>
</ng-template>
